---
title: ""
author: "koji"
date: "2022/1/24"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
```

## download and unzip the file

```{r, cache=TRUE}
path <- getwd()
url <- "https://d396qusza40orc.cloudfront.net/exdata%2Fdata%2FNEI_data.zip"
download.file(url, file.path(path, "exdata_data_NEI_data.zip"))
unzip("exdata_data_NEI_data.zip")
NEI <- readRDS("summarySCC_PM25.rds")
SCC <- readRDS("Source_Classification_Code.rds")
```

## 


```{r, cache=TRUE}
head(NEI)
head(SCC)
```

# total emissions from PM2.5 decreased in the United States from 1999 to 2008
Let's make a plot showing the total PM2.5 emission from all sources for each of the years 1999, 2002, 2005, and 2008 using base plot system.
```{r, cache=TRUE}
merged_data <- merge(NEI, SCC, by = "SCC")
anual_total_emission <- aggregate(Emissions ~ year, data = merged_data, sum, na.rm=TRUE)
plot(anual_total_emission)
```

# total emissions from PM2.5 decreased in the Baltimore City, Maryland (fips == "24510"|}fips == "24510") from 1999 to 2008?

```{r, cache=TRUE}
baltimore_data <- aggregate(Emissions ~ year + type, data = subset(merged_data, fips == "24510"), sum, na.rm=TRUE)
plot(aggregate(Emissions ~ year, data = subset(merged_data, fips == "24510"), sum, na.rm=TRUE))
```

```{r, cache=TRUE}
g <- ggplot(baltimore_data, aes(year, Emissions, color = type)) + geom_line(aes(fill=type), show.legend = TRUE)
g
```


Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
